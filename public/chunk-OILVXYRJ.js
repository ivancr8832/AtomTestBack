import{b as F}from"./chunk-2EKLLISK.js";import{A as z,B as K,b as L,c as f,e as w,f as R,h as N,i as E,j as D,k as I,m as P,y as W,z as J}from"./chunk-MDTO5ZUK.js";import{$a as x,Ba as u,Da as d,Ga as q,Ia as s,Ja as r,Ka as l,La as c,P as G,Qa as b,Qb as H,Ra as v,U as B,V as p,Va as M,W as y,Wa as O,Xa as U,Za as a,a as T,bb as j,cb as V,db as A,e as k,f as h,fb as S,gb as Q,pa as m}from"./chunk-BQ2WWXXJ.js";var X=z.servicesUri+"/user",_=class n{constructor(o){this.httpClient=o}login(o){return new Promise((t,e)=>{this.httpClient.post(`${X}/login`,{email:o}).subscribe({next:i=>{t(i.data)},error:i=>{e(i.error)}})})}register(o){return new Promise((t,e)=>{this.httpClient.post(`${X}`,T({},o)).subscribe({next:i=>{t(i.data)},error:i=>{e(i.error)}})})}static \u0275fac=function(t){return new(t||n)(B(H))};static \u0275prov=G({token:n,factory:n.\u0275fac,providedIn:"root"})};var Z=k(K());var ne=()=>({width:"25rem"});function oe(n,o){n&1&&(r(0,"small",9),a(1,"Name is required."),l())}function re(n,o){if(n&1&&u(0,oe,2,0,"small",9),n&2){let t,e=v();s(!((t=e.registerForm.get("name"))==null||t.errors==null)&&t.errors.required?0:-1)}}function le(n,o){n&1&&(r(0,"small",9),a(1,"Email is required."),l())}function ae(n,o){n&1&&(r(0,"small",9),a(1,"Email format is invalid"),l())}function me(n,o){if(n&1&&u(0,le,2,0,"small",9)(1,ae,2,0,"small",9),n&2){let t,e,i=v();s(!((t=i.registerForm.get("email"))==null||t.errors==null)&&t.errors.required?0:-1),m(),s(!((e=i.registerForm.get("email"))==null||e.errors==null)&&e.errors.email?1:-1)}}var C=class n{visible=!1;registerForm;fb=p(I);authService=p(_);router=p(F);isSubmited=!1;textButtonSubmit="Submit";ngOnInit(){this.registerForm=this.fb.group({name:["",f.required],email:["",[f.required,f.email]]})}onCancel(){this.registerForm.reset(),this.visible=!1}onSubmit(){return h(this,null,function*(){this.isSubmited=!0,this.textButtonSubmit="Loading";try{let o={name:this.registerForm.value.name,email:this.registerForm.value.email},{token:t,user:e}=yield this.authService.register(o);localStorage.setItem("token",t),localStorage.setItem("user",JSON.stringify(e)),this.router.navigate(["/"])}catch(o){Z.Notify.failure(o.message)}finally{this.isSubmited=!1,this.textButtonSubmit="Submit"}})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=y({type:n,selectors:[["app-register"]],inputs:{visible:"visible"},standalone:!0,features:[S],decls:17,vars:11,consts:[["header","Register User",3,"visibleChange","modal","visible","closable"],[1,"mt-6","space-y-4",3,"ngSubmit","formGroup"],["for","name",1,"block","text-sm","font-medium","text-gray-600"],["type","text","name","name","formControlName","name",1,"w-full","px-4","py-2","mt-2","border","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-400","focus:border-transparent"],["for","email",1,"block","text-sm","font-medium","text-gray-600"],["type","email","id","email","name","email","formControlName","email",1,"w-full","px-4","py-2","mt-2","border","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-400","focus:border-transparent"],[1,"mt-6","flex","justify-end","space-x-3"],["type","button",1,"px-4","py-2","text-gray-700","bg-gray-200","rounded-lg","hover:bg-gray-300","focus:outline-none",3,"click"],["type","submit",1,"px-4","py-2","bg-indigo-600","text-white","font-semibold","rounded-md","shadow-sm","hover:bg-indigo-700","focus:outline-none","focus:ring-2","focus:ring-indigo-500","disabled:bg-indigo-300",3,"disabled"],[1,"text-red-600"]],template:function(t,e){if(t&1&&(r(0,"p-dialog",0),A("visibleChange",function(g){return V(e.visible,g)||(e.visible=g),g}),r(1,"form",1),b("ngSubmit",function(){return e.onSubmit()}),r(2,"div")(3,"label",2),a(4,"Name"),l(),c(5,"input",3),u(6,re,1,1),l(),r(7,"div")(8,"label",4),a(9,"Email"),l(),c(10,"input",5),u(11,me,2,2),l(),r(12,"div",6)(13,"button",7),b("click",function(){return e.onCancel()}),a(14,"Cancel"),l(),r(15,"button",8),a(16),l()()()()),t&2){let i,g;q(Q(10,ne)),d("modal",!0),j("visible",e.visible),d("closable",!0),m(),d("formGroup",e.registerForm),m(5),s((i=e.registerForm.get("name"))!=null&&i.invalid&&((i=e.registerForm.get("name"))!=null&&i.touched)?6:-1),m(5),s((g=e.registerForm.get("email"))!=null&&g.invalid&&((g=e.registerForm.get("email"))!=null&&g.touched)?11:-1),m(4),d("disabled",e.registerForm.invalid||e.isSubmited),m(),x(" ",e.textButtonSubmit," ")}},dependencies:[J,W,P,N,L,w,R,E,D]})};var ee=k(K());function se(n,o){n&1&&(r(0,"small",11),a(1,"Email is required."),l())}function ue(n,o){n&1&&(r(0,"small",11),a(1,"Email format is invalid"),l())}function ge(n,o){if(n&1&&u(0,se,2,0,"small",11)(1,ue,2,0,"small",11),n&2){let t,e,i=v();s(!((t=i.loginForm.get("email"))==null||t.errors==null)&&t.errors.required?0:-1),m(),s(!((e=i.loginForm.get("email"))==null||e.errors==null)&&e.errors.email?1:-1)}}function pe(n,o){n&1&&c(0,"i",7)}var $=class n{loginForm;fb=p(I);authService=p(_);router=p(F);loadingLogin=!1;textButtonLogin="Login";registerComponentDialog;ngOnInit(){this.loginForm=this.fb.group({email:["",[f.required,f.email]]})}openDialogRegister(){this.registerComponentDialog&&(this.registerComponentDialog.visible=!0)}onSubmit(){return h(this,null,function*(){this.loadingLogin=!0,this.textButtonLogin="Loading";try{let{token:o,user:t}=yield this.authService.login(this.loginForm.value.email);localStorage.setItem("token",o),localStorage.setItem("user",JSON.stringify(t)),this.router.navigate(["/"])}catch(o){ee.Notify.failure(o.message),this.registerComponentDialog&&(this.registerComponentDialog.visible=!0)}finally{this.loadingLogin=!1,this.textButtonLogin="Login"}})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=y({type:n,selectors:[["app-login-page"]],viewQuery:function(t,e){if(t&1&&M(C,5),t&2){let i;O(i=U())&&(e.registerComponentDialog=i.first)}},standalone:!0,features:[S],decls:19,vars:5,consts:[[1,"bg-gray-100","flex","items-center","justify-center","min-h-screen"],[1,"w-full","max-w-md","p-8","mx-4","bg-white","rounded-lg","shadow-lg","sm:mx-auto"],[1,"text-2xl","font-bold","text-center","text-gray-800"],[1,"mt-6","space-y-4",3,"ngSubmit","formGroup"],["for","email",1,"block","text-sm","font-medium","text-gray-600"],["type","email","name","email","formControlName","email",1,"w-full","px-4","py-2","mt-2","border","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-400","focus:border-transparent"],["type","submit",1,"w-full","px-4","py-2","bg-indigo-600","text-white","font-semibold","rounded-md","shadow-sm","hover:bg-indigo-700","focus:outline-none","focus:ring-2","focus:ring-indigo-500","disabled:bg-indigo-300",3,"disabled"],[1,"pi","pi-spin","pi-spinner"],[1,"mt-6","text-center"],[1,"text-sm","text-gray-600"],[1,"font-medium","text-blue-500","hover:underline","cursor-pointer",3,"click"],[1,"text-red-600"]],template:function(t,e){if(t&1&&(r(0,"div",0)(1,"div",1)(2,"h2",2),a(3,"Login"),l(),r(4,"form",3),b("ngSubmit",function(){return e.onSubmit()}),r(5,"div")(6,"label",4),a(7,"Email"),l(),c(8,"input",5),u(9,ge,2,2),l(),r(10,"button",6),u(11,pe,1,0,"i",7),a(12),l()(),r(13,"div",8)(14,"p",9),a(15,"Don't have an account? "),r(16,"a",10),b("click",function(){return e.openDialogRegister()}),a(17,"Register"),l()()()()(),c(18,"app-register")),t&2){let i;m(4),d("formGroup",e.loginForm),m(5),s((i=e.loginForm.get("email"))!=null&&i.invalid&&((i=e.loginForm.get("email"))!=null&&i.touched)?9:-1),m(),d("disabled",e.loginForm.invalid||e.loadingLogin),m(),s(e.loadingLogin?11:-1),m(),x(" ",e.textButtonLogin," ")}},dependencies:[C,P,N,L,w,R,E,D]})};export{$ as LoginPageComponent};
